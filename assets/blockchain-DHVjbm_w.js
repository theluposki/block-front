import{_ as S,h as B,r as m,i as $,c as k,o as x,j as E,a as e,F as N,k as q,t as v,l as w,b as j,f as H,v as J,u as _}from"./index-C7BARXcY.js";import{d as M}from"./db-sBcmA5xO.js";import"./_commonjsHelpers-C4iS2aBk.js";const C={"json-container":"_json-container_1yqab_22","json-key":"_json-key_1yqab_26","json-string":"_json-string_1yqab_30","json-number":"_json-number_1yqab_34","json-boolean":"_json-boolean_1yqab_38","json-null":"_json-null_1yqab_42"},O=["innerHTML"],F={__name:"JsonViewer",props:{jsonText:Object},setup(a){const n=a;B(()=>{});const r=m(""),l=()=>({key:"color: #ffb86c;",string:"color: #50fa7b;",number:"color: #bd93f9;",boolean:"color: #8be9fd;",null:"color: #ff5555;"}),o=u=>{if(!u)return;let c=JSON==null?void 0:JSON.parse(JSON==null?void 0:JSON.stringify(u));const t=l();return typeof c!="string"&&(c=JSON.stringify(c,null,2)),c=c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),c.replace(/("(\\u[\da-fA-F]{4}|\\[^u"]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(\.\d+)?([eE][+-]?\d+)?)/g,i=>{let f="";return/^"/.test(i)?/:$/.test(i)?f=t.key:f=t.string:/true|false/.test(i)?f=t.boolean:/null/.test(i)?f=t.null:f=t.number,`<span style="${f}">${i}</span>`})};return $(()=>{r.value=o(n.jsonText)}),(u,c)=>(x(),k("pre",{innerHTML:r.value,class:"json-container"},null,8,O))}},I={$style:C},D=S(F,[["__cssModules",I]]),V=()=>({index:1,hash:"0000",timestamp:Date.now(),data:{},lastHash:"0000"});function W(a){return new Worker("/block-front/assets/mineWorker-Ddti26rs.js",{name:a==null?void 0:a.name})}const L=E("blockchain",()=>{const a=m([]),n=m(2),r=m(!1),l=m({hash:"",nonce:0,difficulty:n.value,workerIndex:0}),o=m([]),u=m(null),c=s=>{n.value=s},t=async s=>{a.value.push(s),await M.blocks.add(s)},i=async()=>{const s=await M.blocks.orderBy("index").toArray();if(s&&s.length>0)a.value=s;else{const p=V();a.value=[p],await M.blocks.add(p)}},f=()=>{if(!u.value)return"0s";const s=Date.now()-u.value,p=Math.floor(s/(1e3*60*60*24)),g=Math.floor(s%(1e3*60*60*24)/(1e3*60*60)),d=Math.floor(s%(1e3*60*60)/(1e3*60)),h=Math.floor(s%(1e3*60)/1e3),b=s%1e3,y=[];return p>0&&y.push(`${p}d`),g>0&&y.push(`${g}h`),d>0&&y.push(`${d}m`),h>0&&y.push(`${h}s`),b>0&&y.push(`${b}ms`),y.join(" ")},T=()=>{r.value=!1,l.value={},o.value.forEach(d=>d.terminate()),o.value.length=0,u.value=Date.now();const s=JSON.parse(JSON.stringify(a.value.at(-1)));let p=!1;const g=navigator.hardwareConcurrency||4;console.log("hardwareConcurrency: ",navigator.hardwareConcurrency);for(let d=0;d<g;d++){const h=new W;h.postMessage({lastBlock:s,difficulty:n.value,workerIndex:d,startNonce:d*1e5}),h.onmessage=b=>{b.data&&b.data.hash!==l.value.hash&&(l.value=b.data),b.data.done&&!p&&(p=!0,t(b.data.newBlock),o.value.forEach(y=>y.terminate()),o.value.length=0)},o.value.push(h)}},z=()=>{r.value=!0,o.value.forEach(s=>{s.postMessage("stop"),s.terminate()}),o.value.length=0};return i(),{blockchain:a,MineMulti:T,StopMining:z,setDifficulty:c,stop:r,currentHash:l,getElapsedTime:f}}),A={border:"1",cellpadding:"5"},R={__name:"tableDifficulty",setup(a){const n=[{zeros:1,probability:"1 em 16",difficulty:"1x"},{zeros:2,probability:"1 em 256",difficulty:"16x"},{zeros:3,probability:"1 em 4.096",difficulty:"256x"},{zeros:4,probability:"1 em 65.536",difficulty:"4.096x"},{zeros:5,probability:"1 em 1.048.576",difficulty:"65.536x"},{zeros:6,probability:"1 em 16.777.216",difficulty:"1.048.576x"},{zeros:7,probability:"1 em 268.435.456",difficulty:"16.777.216x"},{zeros:8,probability:"1 em 4.294.967.296",difficulty:"268.435.456x"},{zeros:9,probability:"1 em 68.719.476.736",difficulty:"4.294.967.296x"},{zeros:10,probability:"1 em 1.099.511.627.776",difficulty:"68.719.476.736x"},{zeros:11,probability:"1 em 17.592.186.044.416",difficulty:"1.099.511.627.776x"},{zeros:12,probability:"1 em 281.474.976.710.656",difficulty:"17.592.186.044.416x"}];return(r,l)=>(x(),k("div",null,[l[1]||(l[1]=e("h5",null,"Tabela de Dificuldade para Hash com Zeros à Esquerda",-1)),e("table",A,[l[0]||(l[0]=e("thead",null,[e("tr",null,[e("th",null,"Número de Zeros à Esquerda"),e("th",null,"Probabilidade de Acerto (aproximada)"),e("th",null,"Dificuldade Relativa")])],-1)),e("tbody",null,[(x(),k(N,null,q(n,(o,u)=>e("tr",{key:u},[e("td",null,v(o.zeros),1),e("td",null,v(o.probability),1),e("td",null,v(o.difficulty),1)])),64))])])]))}},U=S(R,[["__scopeId","data-v-9a13e33a"]]),K={class:"page-int"},P={class:"container"},Z={class:"group-btns"},Y={class:"green"},ee={__name:"blockchain",setup(a){const n=L(),r=m(2),l=w(()=>n.blockchain),o=w(()=>n.currentHash),u=()=>{n.setDifficulty(r.value)};return(c,t)=>(x(),k("div",K,[e("div",P,[t[4]||(t[4]=e("h3",{class:"title green"},"Blockchain",-1)),t[5]||(t[5]=e("p",{class:"red"},"proof of work",-1)),j(D,{"json-text":o.value},null,8,["json-text"]),e("details",null,[t[3]||(t[3]=e("summary",{class:"green"},"Nível de dificuldade",-1)),j(U)]),H(e("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=i=>r.value=i),class:"input",onKeyup:u,placeholder:"dificuldade",min:"0",max:"10"},null,544),[[J,r.value]]),e("div",Z,[e("button",{class:"btn",onClick:t[1]||(t[1]=(...i)=>_(n).MineMulti&&_(n).MineMulti(...i))},"Mine"),e("button",{class:"btn",onClick:t[2]||(t[2]=(...i)=>_(n).StopMining&&_(n).StopMining(...i))},"Stop")]),e("p",Y,"Tempo de mineração: "+v(_(n).getElapsedTime()),1),j(D,{"json-text":l.value[l.value.length-1]},null,8,["json-text"])])]))}};export{ee as default};
