import{k as h,_ as k,r as v,l as m,c as f,a as d,g as w,t as p,o as _}from"./index-B0UYAhgC.js";function b(g={}){const{immediate:r=!1,onNeedRefresh:t,onOfflineReady:a,onRegistered:i,onRegisteredSW:c,onRegisterError:o}=g;let n,u;const l=async(e=!0)=>{await u};async function s(){if("serviceWorker"in navigator){if(n=await h(async()=>{const{Workbox:e}=await import("./workbox-window.prod.es5-DL_hIMXg.js");return{Workbox:e}},[]).then(({Workbox:e})=>new e("/block-front/sw.js",{scope:"/block-front/",type:"classic"})).catch(e=>{o==null||o(e)}),!n)return;n.addEventListener("activated",e=>{(e.isUpdate||e.isExternal)&&window.location.reload()}),n.addEventListener("installed",e=>{e.isUpdate||a==null||a()}),n.register({immediate:r}).then(e=>{c?c("/block-front/sw.js",e):i==null||i(e)}).catch(e=>{o==null||o(e)})}}return u=s(),l}const y={class:"page"},W={class:"container"},A={key:0},P={__name:"config",setup(g){const r=v(!1),t=v(localStorage.getItem("version")||"Desconhecido"),a=v(null),i=b({onNeedRefresh(){r.value=!0,c()},onOfflineReady(){console.log("PWA pronto para uso offline!")}}),c=async()=>{try{const s=await(await fetch("/block-front/version.json")).json();a.value=s.version,t.value!==a.value&&(localStorage.setItem("version",a.value),t.value=a.value,window.location.reload())}catch{a.value="Desconhecido"}},o=()=>{i(),a.value&&(localStorage.setItem("version",a.value),t.value=a.value),alert("Aplicativo atualizado com sucesso! üöÄ"),window.location.reload()},n=async()=>{if("serviceWorker"in navigator){const l=await navigator.serviceWorker.getRegistrations();for(const s of l)await s.unregister();caches.keys().then(s=>{s.forEach(e=>caches.delete(e))}),alert("PWA reinstalado! P√°gina ser√° recarregada."),window.location.reload()}},u=async()=>{await c(),a.value!==t.value?(r.value=!0,localStorage.setItem("version",a.value),t.value=a.value,alert("Nova vers√£o encontrada: "+a.value),window.location.reload()):alert("Voc√™ j√° est√° na vers√£o mais recente!")};return m(c),(l,s)=>(_(),f("div",y,[d("div",W,[d("p",null,"Vers√£o Atual: "+p(t.value),1),r.value?(_(),f("p",A,"Nova vers√£o dispon√≠vel! ("+p(t.value)+" ‚Üí "+p(a.value)+")",1)):w("",!0),r.value?(_(),f("button",{key:1,class:"btn",onClick:o},"Atualizar")):w("",!0),d("button",{class:"btn",onClick:n},"Reinstalar"),d("button",{class:"btn",onClick:u},"Verificar Atualiza√ß√µes")])]))}},V=k(P,[["__scopeId","data-v-5f233c65"]]);export{V as default};
