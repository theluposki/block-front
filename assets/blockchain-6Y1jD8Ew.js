import{_ as x,r as g,h as w,c as M,o as j,i as S,j as v,a as f,b as k,f as T,v as $,u as _,t as E}from"./index-CvlJnEiF.js";const B={"json-container":"_json-container_1yqab_22","json-key":"_json-key_1yqab_26","json-string":"_json-string_1yqab_30","json-number":"_json-number_1yqab_34","json-boolean":"_json-boolean_1yqab_38","json-null":"_json-null_1yqab_42"},D=["innerHTML"],N={__name:"JsonViewer",props:{jsonText:Object},setup(a){const t=a,r=g(""),i=()=>({key:"color: #ffb86c;",string:"color: #50fa7b;",number:"color: #bd93f9;",boolean:"color: #8be9fd;",null:"color: #ff5555;"}),l=n=>{const c=i();return typeof n!="string"&&(n=JSON.stringify(n,null,2)),n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),n.replace(/("(\\u[\da-fA-F]{4}|\\[^u"]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(\.\d+)?([eE][+-]?\d+)?)/g,e=>{let o="";return/^"/.test(e)?/:$/.test(e)?o=c.key:o=c.string:/true|false/.test(e)?o=c.boolean:/null/.test(e)?o=c.null:o=c.number,`<span style="${o}">${e}</span>`})};return w(()=>{r.value=l(t.jsonText)}),(n,c)=>(j(),M("pre",{innerHTML:r.value,class:"json-container"},null,8,D))}},q={$style:B},y=x(N,[["__cssModules",q]]),H=()=>({index:1,hash:"0000",timestamp:Date.now(),data:{},lastHash:"0000"});function J(a){return new Worker("/block-front/assets/mineWorker-Vdxk6qtc.js",{name:a==null?void 0:a.name})}const V=S("blockchain",()=>{const a=g([H()]),t=g(2),r=g(!1),i=g({}),l=g([]),n=g(null),c=s=>{t.value=s},e=s=>{a.value.push(s)};return{blockchain:a,MineMulti:()=>{r.value=!1,i.value={},l.value.forEach(u=>u.terminate()),l.value.length=0,n.value=Date.now();const s=JSON.parse(JSON.stringify(a.value.at(-1)));let m=!1;const b=4;for(let u=0;u<b;u++){const h=new J;h.postMessage({lastBlock:s,difficulty:t.value,workerIndex:u,startNonce:u*1e5}),h.onmessage=d=>{d.data&&d.data.hash!==i.value.hash&&(i.value=d.data),d.data.done&&!m&&(m=!0,e(d.data.newBlock),l.value.forEach(p=>p.terminate()),l.value.length=0)},l.value.push(h)}},StopMining:()=>{r.value=!0,l.value.forEach(s=>{s.postMessage("stop"),s.terminate()}),l.value.length=0},setDifficulty:c,stop:r,currentHash:i,getElapsedTime:()=>{if(!n.value)return"0s";const s=Date.now()-n.value,m=Math.floor(s/(1e3*60*60*24)),b=Math.floor(s%(1e3*60*60*24)/(1e3*60*60)),u=Math.floor(s%(1e3*60*60)/(1e3*60)),h=Math.floor(s%(1e3*60)/1e3),d=s%1e3,p=[];return m>0&&p.push(`${m}d`),b>0&&p.push(`${b}h`),u>0&&p.push(`${u}m`),h>0&&p.push(`${h}s`),d>0&&p.push(`${d}ms`),p.join(" ")}}}),O={class:"page-int"},W={class:"container"},C={class:"group-btns"},I={class:"green"},K={__name:"blockchain",setup(a){const t=V(),r=g(2),i=v(()=>t.blockchain),l=v(()=>t.currentHash),n=()=>{t.setDifficulty(r.value)};return(c,e)=>(j(),M("div",O,[f("div",W,[e[3]||(e[3]=f("h3",{class:"title green"},"Blockchain",-1)),e[4]||(e[4]=f("p",{class:"red"},"proof of work",-1)),k(y,{"json-text":l.value},null,8,["json-text"]),e[5]||(e[5]=f("p",{class:"green"},"Nível de dificuldade",-1)),T(f("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),class:"input",onKeyup:n,placeholder:"dificuldade",min:"0",max:"10"},null,544),[[$,r.value]]),f("div",C,[f("button",{class:"btn",onClick:e[1]||(e[1]=(...o)=>_(t).MineMulti&&_(t).MineMulti(...o))},"Mine"),f("button",{class:"btn",onClick:e[2]||(e[2]=(...o)=>_(t).StopMining&&_(t).StopMining(...o))},"Stop")]),f("p",I,"Tempo de mineração: "+E(_(t).getElapsedTime()),1),k(y,{"json-text":i.value[i.value.length-1]},null,8,["json-text"])])]))}};export{K as default};
