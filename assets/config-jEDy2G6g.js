import{k,_ as w,r as d,l as m,c as f,a as v,g as h,t as p,o as _}from"./index--fO9S8P_.js";function b(g={}){const{immediate:r=!1,onNeedRefresh:t,onOfflineReady:e,onRegistered:i,onRegisteredSW:c,onRegisterError:o}=g;let n,u;const l=async(a=!0)=>{await u};async function s(){if("serviceWorker"in navigator){if(n=await k(async()=>{const{Workbox:a}=await import("./workbox-window.prod.es5-DL_hIMXg.js");return{Workbox:a}},[]).then(({Workbox:a})=>new a("/block-front/sw.js",{scope:"/block-front/",type:"classic"})).catch(a=>{o==null||o(a)}),!n)return;n.addEventListener("activated",a=>{(a.isUpdate||a.isExternal)&&window.location.reload()}),n.addEventListener("installed",a=>{a.isUpdate||e==null||e()}),n.register({immediate:r}).then(a=>{c?c("/block-front/sw.js",a):i==null||i(a)}).catch(a=>{o==null||o(a)})}}return u=s(),l}const y={class:"page"},W={class:"container"},A={key:0},V={__name:"config",setup(g){const r=d(!1),t=d(localStorage.getItem("version")||"Desconhecido"),e=d(null),i=b({onNeedRefresh(){r.value=!0,c()},onOfflineReady(){console.log("PWA pronto para uso offline!")}}),c=async()=>{try{const s=await(await fetch("/block-front/version.json")).json();e.value=s.version,console.log("newVersion",e.value),t.value!==e.value&&(localStorage.setItem("version",e.value),t.value=e.value)}catch{e.value="Desconhecido"}},o=()=>{i(),e.value&&(localStorage.setItem("version",e.value),t.value=e.value),alert("Aplicativo atualizado com sucesso! üöÄ")},n=async()=>{if("serviceWorker"in navigator){const l=await navigator.serviceWorker.getRegistrations();for(const s of l)await s.unregister();caches.keys().then(s=>{s.forEach(a=>caches.delete(a))}),alert("PWA reinstalado! P√°gina ser√° recarregada."),window.location.reload()}},u=async()=>{await c(),e.value!==t.value?(r.value=!0,localStorage.setItem("version",e.value),t.value=e.value,alert("Nova vers√£o encontrada: "+e.value)):alert("Voc√™ j√° est√° na vers√£o mais recente!")};return m(c),(l,s)=>(_(),f("div",y,[v("div",W,[v("p",null,"Vers√£o Atual: "+p(t.value),1),r.value?(_(),f("p",A,"Nova vers√£o dispon√≠vel! ("+p(t.value)+" ‚Üí "+p(e.value)+")",1)):h("",!0),r.value?(_(),f("button",{key:1,class:"btn",onClick:o},"Atualizar")):h("",!0),v("button",{class:"btn",onClick:n},"Reinstalar"),v("button",{class:"btn",onClick:u},"Verificar Atualiza√ß√µes")])]))}},S=w(V,[["__scopeId","data-v-8a9b546a"]]);export{S as default};
