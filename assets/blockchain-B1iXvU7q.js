import{_ as D,r as y,h as $,c as v,o as k,i as S,a as e,F as E,j as q,t as g,k as j,b as x,f as N,v as H,u as h}from"./index-BoGxlpu5.js";import{d as M}from"./db-sBcmA5xO.js";import"./_commonjsHelpers-C4iS2aBk.js";const C={"json-container":"_json-container_1yqab_22","json-key":"_json-key_1yqab_26","json-string":"_json-string_1yqab_30","json-number":"_json-number_1yqab_34","json-boolean":"_json-boolean_1yqab_38","json-null":"_json-null_1yqab_42"},F=["innerHTML"],J={__name:"JsonViewer",props:{jsonText:Object},setup(r){const n=r,u=y(""),a=()=>({key:"color: #ffb86c;",string:"color: #50fa7b;",number:"color: #bd93f9;",boolean:"color: #8be9fd;",null:"color: #ff5555;"}),o=l=>{const c=a();return typeof l!="string"&&(l=JSON.stringify(l,null,2)),l=l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),l.replace(/("(\\u[\da-fA-F]{4}|\\[^u"]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(\.\d+)?([eE][+-]?\d+)?)/g,t=>{let i="";return/^"/.test(t)?/:$/.test(t)?i=c.key:i=c.string:/true|false/.test(t)?i=c.boolean:/null/.test(t)?i=c.null:i=c.number,`<span style="${i}">${t}</span>`})};return $(()=>{u.value=o(n.jsonText)}),(l,c)=>(k(),v("pre",{innerHTML:u.value,class:"json-container"},null,8,F))}},V={$style:C},w=D(J,[["__cssModules",V]]),I=()=>({index:1,hash:"0000",timestamp:Date.now(),data:{},lastHash:"0000"});function O(r){return new Worker("/block-front/assets/mineWorker-Vdxk6qtc.js",{name:r==null?void 0:r.name})}const W=S("blockchain",()=>{const r=y([]),n=y(2),u=y(!1),a=y({}),o=y([]),l=y(null),c=s=>{n.value=s},t=async s=>{r.value.push(s),await M.blocks.add(s)},i=async()=>{const s=await M.blocks.orderBy("index").toArray();if(s&&s.length>0)r.value=s;else{const f=I();r.value=[f],await M.blocks.add(f)}},T=()=>{if(!l.value)return"0s";const s=Date.now()-l.value,f=Math.floor(s/(1e3*60*60*24)),_=Math.floor(s%(1e3*60*60*24)/(1e3*60*60)),d=Math.floor(s%(1e3*60*60)/(1e3*60)),m=Math.floor(s%(1e3*60)/1e3),p=s%1e3,b=[];return f>0&&b.push(`${f}d`),_>0&&b.push(`${_}h`),d>0&&b.push(`${d}m`),m>0&&b.push(`${m}s`),p>0&&b.push(`${p}ms`),b.join(" ")},z=()=>{u.value=!1,a.value={},o.value.forEach(d=>d.terminate()),o.value.length=0,l.value=Date.now();const s=JSON.parse(JSON.stringify(r.value.at(-1)));let f=!1;const _=navigator.hardwareConcurrency||4;console.log("hardwareConcurrency: ",navigator.hardwareConcurrency);for(let d=0;d<_;d++){const m=new O;m.postMessage({lastBlock:s,difficulty:n.value,workerIndex:d,startNonce:d*1e5}),m.onmessage=p=>{p.data&&p.data.hash!==a.value.hash&&(a.value=p.data),p.data.done&&!f&&(f=!0,t(p.data.newBlock),o.value.forEach(b=>b.terminate()),o.value.length=0)},o.value.push(m)}},B=()=>{u.value=!0,o.value.forEach(s=>{s.postMessage("stop"),s.terminate()}),o.value.length=0};return i(),{blockchain:r,MineMulti:z,StopMining:B,setDifficulty:c,stop:u,currentHash:a,getElapsedTime:T}}),L={border:"1",cellpadding:"5"},A={__name:"tableDifficulty",setup(r){const n=[{zeros:1,probability:"1 em 16",difficulty:"1x"},{zeros:2,probability:"1 em 256",difficulty:"16x"},{zeros:3,probability:"1 em 4.096",difficulty:"256x"},{zeros:4,probability:"1 em 65.536",difficulty:"4.096x"},{zeros:5,probability:"1 em 1.048.576",difficulty:"65.536x"},{zeros:6,probability:"1 em 16.777.216",difficulty:"1.048.576x"},{zeros:7,probability:"1 em 268.435.456",difficulty:"16.777.216x"},{zeros:8,probability:"1 em 4.294.967.296",difficulty:"268.435.456x"},{zeros:9,probability:"1 em 68.719.476.736",difficulty:"4.294.967.296x"},{zeros:10,probability:"1 em 1.099.511.627.776",difficulty:"68.719.476.736x"},{zeros:11,probability:"1 em 17.592.186.044.416",difficulty:"1.099.511.627.776x"},{zeros:12,probability:"1 em 281.474.976.710.656",difficulty:"17.592.186.044.416x"}];return(u,a)=>(k(),v("div",null,[a[1]||(a[1]=e("h5",null,"Tabela de Dificuldade para Hash com Zeros à Esquerda",-1)),e("table",L,[a[0]||(a[0]=e("thead",null,[e("tr",null,[e("th",null,"Número de Zeros à Esquerda"),e("th",null,"Probabilidade de Acerto (aproximada)"),e("th",null,"Dificuldade Relativa")])],-1)),e("tbody",null,[(k(),v(E,null,q(n,(o,l)=>e("tr",{key:l},[e("td",null,g(o.zeros),1),e("td",null,g(o.probability),1),e("td",null,g(o.difficulty),1)])),64))])])]))}},R=D(A,[["__scopeId","data-v-9a13e33a"]]),U={class:"page-int"},K={class:"container"},P={class:"group-btns"},Z={class:"green"},X={__name:"blockchain",setup(r){const n=W(),u=y(2),a=j(()=>n.blockchain),o=j(()=>n.currentHash),l=()=>{n.setDifficulty(u.value)};return(c,t)=>(k(),v("div",U,[e("div",K,[t[4]||(t[4]=e("h3",{class:"title green"},"Blockchain",-1)),t[5]||(t[5]=e("p",{class:"red"},"proof of work",-1)),x(w,{"json-text":o.value},null,8,["json-text"]),e("details",null,[t[3]||(t[3]=e("summary",{class:"green"},"Nível de dificuldade",-1)),x(R)]),N(e("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=i=>u.value=i),class:"input",onKeyup:l,placeholder:"dificuldade",min:"0",max:"10"},null,544),[[H,u.value]]),e("div",P,[e("button",{class:"btn",onClick:t[1]||(t[1]=(...i)=>h(n).MineMulti&&h(n).MineMulti(...i))},"Mine"),e("button",{class:"btn",onClick:t[2]||(t[2]=(...i)=>h(n).StopMining&&h(n).StopMining(...i))},"Stop")]),e("p",Z,"Tempo de mineração: "+g(h(n).getElapsedTime()),1),x(w,{"json-text":a.value[a.value.length-1]},null,8,["json-text"])])]))}};export{X as default};
