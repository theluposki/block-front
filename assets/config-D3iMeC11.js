import{a as k,r as v,b as w,c as d,d as f,e as h,t as p,o as g}from"./index-ReMf9eln.js";function m(_={}){const{immediate:r=!1,onNeedRefresh:s,onOfflineReady:a,onRegistered:c,onRegisteredSW:i,onRegisterError:t}=_;let n,u;const l=async(e=!0)=>{await u};async function o(){if("serviceWorker"in navigator){if(n=await k(async()=>{const{Workbox:e}=await import("./workbox-window.prod.es5-DL_hIMXg.js");return{Workbox:e}},[]).then(({Workbox:e})=>new e("/block-front/sw.js",{scope:"/block-front/",type:"classic"})).catch(e=>{t==null||t(e)}),!n)return;n.addEventListener("activated",e=>{(e.isUpdate||e.isExternal)&&window.location.reload()}),n.addEventListener("installed",e=>{e.isUpdate||a==null||a()}),n.register({immediate:r}).then(e=>{i?i("/block-front/sw.js",e):c==null||c(e)}).catch(e=>{t==null||t(e)})}}return u=o(),l}const b={class:"page"},y={key:0},A={__name:"config",setup(_){const r=v(!1),s=v(localStorage.getItem("version")||"Desconhecido"),a=v(null),c=m({onNeedRefresh(){r.value=!0,i()},onOfflineReady(){console.log("PWA pronto para uso offline!")}}),i=async()=>{try{const o=await(await fetch("/version.json")).json();a.value=o.version,s.value!==a.value&&(localStorage.setItem("version",a.value),s.value=a.value)}catch{a.value="Desconhecido"}},t=()=>{c(),a.value&&(localStorage.setItem("version",a.value),s.value=a.value),alert("Aplicativo atualizado com sucesso! üöÄ")},n=async()=>{if("serviceWorker"in navigator){const l=await navigator.serviceWorker.getRegistrations();for(const o of l)await o.unregister();caches.keys().then(o=>{o.forEach(e=>caches.delete(e))}),alert("PWA reinstalado! P√°gina ser√° recarregada."),window.location.reload()}},u=async()=>{await i(),a.value!==s.value?(r.value=!0,alert("Nova vers√£o encontrada: "+a.value)):alert("Voc√™ j√° est√° na vers√£o mais recente!")};return w(i),(l,o)=>(g(),d("div",b,[f("p",null,"Vers√£o Atual: "+p(s.value),1),r.value?(g(),d("p",y,"Nova vers√£o dispon√≠vel! ("+p(s.value)+" ‚Üí "+p(a.value)+")",1)):h("",!0),r.value?(g(),d("button",{key:1,class:"btn",onClick:t},"Atualizar")):h("",!0),f("button",{class:"btn btn-danger",onClick:n},"Reinstalar"),f("button",{class:"btn btn-secondary",onClick:u},"Verificar Atualiza√ß√µes")]))}};export{A as default};
