import{k,_ as w,r as d,l as m,c as f,a as v,g as h,t as p,o as _}from"./index-DSzQYch-.js";function b(g={}){const{immediate:r=!1,onNeedRefresh:s,onOfflineReady:a,onRegistered:i,onRegisteredSW:c,onRegisterError:t}=g;let n,u;const l=async(e=!0)=>{await u};async function o(){if("serviceWorker"in navigator){if(n=await k(async()=>{const{Workbox:e}=await import("./workbox-window.prod.es5-DL_hIMXg.js");return{Workbox:e}},[]).then(({Workbox:e})=>new e("/block-front/sw.js",{scope:"/block-front/",type:"classic"})).catch(e=>{t==null||t(e)}),!n)return;n.addEventListener("activated",e=>{(e.isUpdate||e.isExternal)&&window.location.reload()}),n.addEventListener("installed",e=>{e.isUpdate||a==null||a()}),n.register({immediate:r}).then(e=>{c?c("/block-front/sw.js",e):i==null||i(e)}).catch(e=>{t==null||t(e)})}}return u=o(),l}const y={class:"page"},W={class:"container"},A={key:0},V={__name:"config",setup(g){const r=d(!1),s=d(localStorage.getItem("version")||"Desconhecido"),a=d(null),i=b({onNeedRefresh(){r.value=!0,c()},onOfflineReady(){console.log("PWA pronto para uso offline!")}}),c=async()=>{try{const o=await(await fetch("/block-front/version.json")).json();a.value=o.version,console.log("newVersion",a),alert(JSON.stringify(a,null,2)),s.value!==a.value&&(localStorage.setItem("version",a.value),s.value=a.value)}catch{a.value="Desconhecido"}},t=()=>{i(),a.value&&(localStorage.setItem("version",a.value),s.value=a.value),alert("Aplicativo atualizado com sucesso! üöÄ")},n=async()=>{if("serviceWorker"in navigator){const l=await navigator.serviceWorker.getRegistrations();for(const o of l)await o.unregister();caches.keys().then(o=>{o.forEach(e=>caches.delete(e))}),alert("PWA reinstalado! P√°gina ser√° recarregada."),window.location.reload()}},u=async()=>{await c(),a.value!==s.value?(r.value=!0,alert("Nova vers√£o encontrada: "+a.value)):alert("Voc√™ j√° est√° na vers√£o mais recente!")};return m(c),(l,o)=>(_(),f("div",y,[v("div",W,[v("p",null,"Vers√£o Atual: "+p(s.value),1),r.value?(_(),f("p",A,"Nova vers√£o dispon√≠vel! ("+p(s.value)+" ‚Üí "+p(a.value)+")",1)):h("",!0),r.value?(_(),f("button",{key:1,class:"btn",onClick:t},"Atualizar")):h("",!0),v("button",{class:"btn",onClick:n},"Reinstalar"),v("button",{class:"btn",onClick:u},"Verificar Atualiza√ß√µes")])]))}},S=w(V,[["__scopeId","data-v-c0266a30"]]);export{S as default};
